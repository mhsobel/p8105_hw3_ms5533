Homework 3
================
Marisa Sobel
10/7/2018

## Problem 1

Data cleaning

``` r
# add library that includes dataset 
library("p8105.datasets")

# import brfss_smart2010 data, clean names, filter by "Overall Health", remove unwanted vars
# make "response" a factor variable

brfss_data = 
  brfss_smart2010 %>% 
  janitor::clean_names() %>% 
  filter(topic == "Overall Health") %>% 
  select(-class, -topic, -question, 
         -sample_size, -(confidence_limit_low:geo_location)) %>% 
  mutate(
    response = factor(response, 
                      levels = c("Excellent", "Very good", "Good", "Fair", "Poor"))
  )

brfss_data
## # A tibble: 10,625 x 5
##     year locationabbr locationdesc          response  data_value
##    <int> <chr>        <chr>                 <fct>          <dbl>
##  1  2010 AL           AL - Jefferson County Excellent      18.9 
##  2  2010 AL           AL - Jefferson County Very good      30.0 
##  3  2010 AL           AL - Jefferson County Good           33.1 
##  4  2010 AL           AL - Jefferson County Fair           12.5 
##  5  2010 AL           AL - Jefferson County Poor            5.50
##  6  2010 AL           AL - Mobile County    Excellent      15.6 
##  7  2010 AL           AL - Mobile County    Very good      31.3 
##  8  2010 AL           AL - Mobile County    Good           31.2 
##  9  2010 AL           AL - Mobile County    Fair           15.5 
## 10  2010 AL           AL - Mobile County    Poor            6.40
## # ... with 10,615 more rows
```

### Questions

1.  *_In 2002, which states were observed at 7
locations?_*

<!-- end list -->

``` r
# Filter by year, group by state, summarize number of locations in each state
brfss_data %>% 
  filter(year == 2002) %>% 
  group_by(locationabbr) %>% 
  summarise(
    number = n()
  )
## # A tibble: 49 x 2
##    locationabbr number
##    <chr>         <int>
##  1 AK                5
##  2 AL                5
##  3 AR                5
##  4 AZ               10
##  5 CA                5
##  6 CO               20
##  7 CT               35
##  8 DC                5
##  9 DE               15
## 10 FL               35
## # ... with 39 more rows
```

None (????)

2.  *_Make a “spaghetti plot” that shows the number of observations in
    each state from 2002 to
2010._*

<!-- end list -->

``` r
# Group by year and state, summarize number of locations in each state (n)
# Line plot of year vs n
brfss_data %>% 
  group_by(year, locationabbr) %>% 
  summarise(
    number = n()) %>% 
  ggplot(aes(x = year, y = number, color = locationabbr)) +
  geom_line() +
   labs(
    title = "Number of Observations by State (2002-2010)", 
    x = "Year", 
    y = "Number of Obs", 
    legend = "State") +
  viridis::scale_color_viridis(discrete = TRUE) +
  theme(legend.position = "right")
```

![](p8105_hw3_ms5533_files/figure-gfm/unnamed-chunk-3-1.png)<!-- -->

``` r

# CANNOT GET LEGEND TO LABEL
```

3.  *_Make a table showing, for the years 2002, 2006, and 2010, the mean
    and standard deviation of the proportion of “Excellent” responses
    across locations in NY State._*

<!-- end list -->

``` r
# Filter: 1) NY, 2) year (2002, 2006, 2010)
# Group by location 
# Confused about how to get proportion, but do notice the order is the same each time (excellent --> poor)

brfss_data %>% 
  filter(locationabbr == "NY") %>% 
  filter(year == 2002 | year == 2006 | year == 2010) %>% 
  group_by(locationdesc)
```

    ## # A tibble: 100 x 5
    ## # Groups:   locationdesc [9]
    ##     year locationabbr locationdesc      response  data_value
    ##    <int> <chr>        <chr>             <fct>          <dbl>
    ##  1  2010 NY           NY - Bronx County Excellent      17.6 
    ##  2  2010 NY           NY - Bronx County Very good      25.9 
    ##  3  2010 NY           NY - Bronx County Good           35.1 
    ##  4  2010 NY           NY - Bronx County Fair           16.7 
    ##  5  2010 NY           NY - Bronx County Poor            4.70
    ##  6  2010 NY           NY - Erie County  Excellent      17.2 
    ##  7  2010 NY           NY - Erie County  Very good      37.9 
    ##  8  2010 NY           NY - Erie County  Good           29.6 
    ##  9  2010 NY           NY - Erie County  Fair           12.7 
    ## 10  2010 NY           NY - Erie County  Poor            2.50
    ## # ... with 90 more rows

``` r
# mutate(prop_excellent = (excellent) /(excellent + very_good + good + fair + poor)) does not work anymore because data structrue is long, not wide
```

4.  *_For each year and state, compute the average proportion in each
    response category (taking the average across locations in a state).
    Make a five-panel plot that shows, for each response category
    separately, the distribution of these state-level averages over
    time._*
